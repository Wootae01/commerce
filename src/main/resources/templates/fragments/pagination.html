<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<nav th:fragment="pager(baseUrl, pageObj, qs)"
     aria-label="Page navigation"
     class="mt-3"
     th:if="${pageObj != null and pageObj.totalPages > 1}"
     th:with="
        cur=${pageObj.number},
        last=${pageObj.totalPages - 1},
        start=${T(java.lang.Math).max(1, cur - 2)},
        end=${T(java.lang.Math).min(last - 1, cur + 2)},
        q=${(qs != null and !#strings.isEmpty(qs)) ? '&' + qs : ''}
     ">

    <ul class="pagination justify-content-center mb-0">

        <!-- Prev -->
        <li class="page-item" th:classappend="${pageObj.first} ? ' disabled' : ''">
            <a class="page-link"
               th:href="${baseUrl + '?page=' + (cur - 1) + q}">«</a>
        </li>

        <!-- First -->
        <li class="page-item" th:classappend="${cur == 0} ? ' active' : ''">
            <a class="page-link"
               th:text="1"
               th:href="${baseUrl + '?page=0' + q}"></a>
        </li>

        <!-- Left ellipsis -->
        <li class="page-item disabled" th:if="${cur > 3}">
            <span class="page-link">…</span>
        </li>

        <!-- Middle window -->
        <li class="page-item"
            th:if="${pageObj.totalPages > 2}"
            th:each="i : ${#numbers.sequence(start, end)}"
            th:classappend="${i == cur} ? ' active' : ''">
            <a class="page-link"
               th:text="${i + 1}"
               th:href="${baseUrl + '?page=' + i + q}"></a>
        </li>

        <!-- Right ellipsis -->
        <li class="page-item disabled" th:if="${cur < last - 3}">
            <span class="page-link">…</span>
        </li>

        <!-- Last -->
        <li class="page-item" th:classappend="${cur == last} ? ' active' : ''">
            <a class="page-link"
               th:text="${pageObj.totalPages}"
               th:href="${baseUrl + '?page=' + last + q}"></a>
        </li>

        <!-- Next -->
        <li class="page-item" th:classappend="${pageObj.last} ? ' disabled' : ''">
            <a class="page-link"
               th:href="${baseUrl + '?page=' + (cur + 1) + q}">»</a>
        </li>

    </ul>
</nav>

</body>
</html>
